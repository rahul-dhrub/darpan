<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Group Video Chat</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap">
  <!-- TensorFlow.js -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
  <!-- BodyPix for background segmentation -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/body-pix"></script>
</head>
<body>
  <div class="container">
    <div class="main-content">
      <div class="header">
        <h2>Darpan</h2>
        <div class="header-controls">
          <div class="meeting-info">
            <span class="meeting-time" id="meetingTime">00:00:00</span>
            <span class="meeting-participants" id="participantCount">0</span>
            <span class="material-icons">people</span>
          </div>
          <button id="chatToggleBtn" class="control-btn" title="Toggle Chat">
            <span class="material-icons control-icon">chat</span>
          </button>
        </div>
      </div>
      <button id="headerToggle" class="header-toggle" title="Toggle Navbar">
        <span class="material-icons">expand_more</span>
      </button>
      
      <!-- Grid view (default mode) -->
      <div id="videos" class="videos-container"></div>
      
      <!-- Pinned view -->
      <div class="pinned-video-container">
        <div class="pinned-video-wrapper" id="pinnedVideoWrapper">
          <!-- Pinned video will be moved here -->
        </div>
      </div>
      
      <div class="participants-sidebar" id="participantsSidebar">
        <!-- Other videos will be moved here -->
      </div>
      
      <div class="controls-container" style="position: relative;">
        <div class="controls">
          <button id="muteBtn" class="control-btn">
            <span class="material-icons control-icon">mic</span>
            <span class="control-text">Mute</span>
          </button>
          
          <button id="videoBtn" class="control-btn">
            <span class="material-icons control-icon">videocam</span>
            <span class="control-text">Stop Video</span>
          </button>
          
          <button id="backgroundBtn" class="control-btn">
            <span class="material-icons control-icon">wallpaper</span>
            <span class="control-text">Background</span>
          </button>
          
          <button id="reactionsBtn" class="control-btn">
            <span class="material-icons control-icon">emoji_emotions</span>
            <span class="control-text">Reactions</span>
          </button>
          
          <button id="raiseHandBtn" class="control-btn">
            <span class="material-icons control-icon">back_hand</span>
            <span class="control-text">Raise Hand</span>
          </button>
          
          <button id="screenShareBtn" class="control-btn">
            <span class="material-icons control-icon">screen_share</span>
            <span class="control-text">Share Screen</span>
          </button>
          
          <button id="stopScreenShareBtn" class="control-btn" disabled>
            <span class="material-icons control-icon">stop_screen_share</span>
            <span class="control-text">Stop Share</span>
          </button>
          
          <button id="recordBtn" class="control-btn">
            <span class="material-icons control-icon">fiber_manual_record</span>
            <span class="control-text">Record</span>
          </button>
          
          <button id="stopRecordBtn" class="control-btn" disabled>
            <span class="material-icons control-icon">stop</span>
            <span class="control-text">Stop Recording</span>
          </button>
          
          <button id="leaveBtn" class="control-btn danger">
            <span class="material-icons control-icon">call_end</span>
            <span class="control-text">Leave</span>
          </button>
        </div>
        <button id="controlsToggle" class="controls-toggle" title="Toggle Controls">
          <span class="material-icons">expand_more</span>
        </button>
      </div>
    </div>
    
    <div id="sidebar" class="sidebar sidebar-hidden">
      <div class="chat-area">
        <div class="header">
          <h2>Chat</h2>
          <button id="chatCollapseBtn" class="chat-collapse-btn" title="Collapse Chat">
            <span class="material-icons">close</span>
          </button>
        </div>
        
        <div id="chatMessages" class="chat-messages"></div>
        
        <div class="chat-input-area">
          <textarea id="chatInput" class="chat-input" placeholder="Type a message..."></textarea>
          <button id="sendBtn" class="send-btn">
            <span class="material-icons">send</span>
          </button>
        </div>
      </div>
    </div>
    
    <!-- Background effects panel -->
    <div id="backgroundPanel" class="side-panel background-panel hidden">
      <div class="panel-header">
        <h2>Background Effects</h2>
        <button id="backgroundPanelClose" class="panel-close-btn">
          <span class="material-icons">close</span>
        </button>
      </div>
      
      <div class="panel-content">
        <div class="background-effects-options">
          <div class="background-effect-option none active" data-effect="none">
            <span class="material-icons">highlight_off</span>
            <div class="effect-label">None</div>
          </div>
          
          <div class="background-effect-option blur" data-effect="blur">
            <span class="material-icons">blur_on</span>
            <div class="effect-label">Blur</div>
          </div>
          
          <div class="background-effect-option color" data-effect="color">
            <span class="material-icons">format_color_fill</span>
            <div class="effect-label">Color</div>
          </div>
          
          <div class="background-effect-option" data-effect="image">
            <span class="material-icons">image</span>
            <div class="effect-label">Image</div>
          </div>
        </div>
        
        <!-- Blur background controls -->
        <div id="blur-bg-controls" class="custom-background-controls">
          <div class="blur-slider-container">
            <label for="meeting-blur-intensity">Blur Intensity:</label>
            <input type="range" id="meeting-blur-intensity" min="15" max="40" value="15" class="blur-slider">
            <span id="meeting-blur-value">15</span>
          </div>
        </div>
        
        <!-- Custom color background controls -->
        <div id="color-bg-controls" class="custom-background-controls">
          <div class="color-picker-container">
            <label for="meeting-background-color-picker">Select background color:</label>
            <input type="color" id="meeting-background-color-picker" value="#34a853">
          </div>
          
          <div class="preset-colors">
            <div class="preset-color" data-color="#34a853" style="background-color: #34a853;"></div>
            <div class="preset-color" data-color="#4285f4" style="background-color: #4285f4;"></div>
            <div class="preset-color" data-color="#ea4335" style="background-color: #ea4335;"></div>
            <div class="preset-color" data-color="#fbbc05" style="background-color: #fbbc05;"></div>
            <div class="preset-color" data-color="#673ab7" style="background-color: #673ab7;"></div>
            <div class="preset-color" data-color="#e91e63" style="background-color: #e91e63;"></div>
            <div class="preset-color" data-color="#009688" style="background-color: #009688;"></div>
            <div class="preset-color" data-color="#ff5722" style="background-color: #ff5722;"></div>
          </div>
        </div>
        
        <!-- Custom image background controls -->
        <div id="image-bg-controls" class="custom-background-controls">
          <div class="image-upload-container">
            <label>Choose background image:</label>
            <input type="file" id="meeting-background-image-upload" accept="image/*" style="display: none;">
            <button id="meeting-upload-image-btn" class="bg-btn">
              <span class="material-icons" style="vertical-align: middle; margin-right: 5px;">upload</span>
              Upload Image
            </button>
            
            <div id="meeting-image-preview" class="image-preview"></div>
            
            <div class="preset-backgrounds">
              <div class="preset-background" data-image="images/backgrounds/office.jpg" style="background-image: url('images/backgrounds/office.jpg');"></div>
              <div class="preset-background" data-image="images/backgrounds/beach.jpg" style="background-image: url('images/backgrounds/beach.jpg');"></div>
              <div class="preset-background" data-image="images/backgrounds/mountain.jpg" style="background-image: url('images/backgrounds/mountain.jpg');"></div>
              <div class="preset-background" data-image="images/backgrounds/city.jpeg" style="background-image: url('images/backgrounds/city.jpeg');"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Emoji reactions panel -->
    <div id="reactionsPanel" class="side-panel reactions-panel hidden">
      <div class="panel-header">
        <h2>Emoji Reactions</h2>
        <button id="reactionsPanelClose" class="panel-close-btn">
          <span class="material-icons">close</span>
        </button>
      </div>
      
      <div class="panel-content">
        <div class="reactions-grid">
          <button class="reaction-btn" data-emoji="üëç">üëç</button>
          <button class="reaction-btn" data-emoji="üëè">üëè</button>
          <button class="reaction-btn" data-emoji="‚ù§Ô∏è">‚ù§Ô∏è</button>
          <button class="reaction-btn" data-emoji="üòÇ">üòÇ</button>
          <button class="reaction-btn" data-emoji="üòÆ">üòÆ</button>
          <button class="reaction-btn" data-emoji="üéâ">üéâ</button>
          <button class="reaction-btn" data-emoji="üëã">üëã</button>
          <button class="reaction-btn" data-emoji="üôå">üôå</button>
          <button class="reaction-btn" data-emoji="üî•">üî•</button>
        </div>
      </div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script type="module" src="js/index.js"></script>
</body>
</html>
